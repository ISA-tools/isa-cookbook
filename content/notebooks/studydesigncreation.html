

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Study-design-driven creation of ISA content &#8212; The ISA cookbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/mermaid.js"></script>
    <script src="../../_static/mermaid.min.js"></script>
    <script src="../../_static/mermaid.core.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="canonical" href="https://isa-tools.github.io/isa-cookbook/content/notebooks/studydesigncreation.html" />
    <link rel="shortcut icon" href="../../_static/isa.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://isa-tools.github.io/isa-cookbook/content/notebooks/studydesigncreation.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Study-design-driven creation of ISA content" />
<meta property="og:description" content="Study-design-driven creation of ISA content  In addition to the basic classes for creating ISA objects (such as Investigation, Study, Assay described previously" />
<meta property="og:image"       content="https://isa-tools.github.io/isa-cookbook/_static/isa_footer_logo.svg" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/isa_footer_logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The ISA cookbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../index.html">1. ISA tools API</a>
  </li>
  <li class="">
    <a href="../installation.html">2. ISA-API Installation</a>
  </li>
  <li class="">
    <a href="../isamodel.html">3. ISA data model</a>
  </li>
  <li class="">
    <a href="../reading.html">4. Reading in ISA-Tab or ISA JSON</a>
  </li>
  <li class="">
    <a href="../creation.html">5. Creating ISA content</a>
  </li>
  <li class="">
    <a href="../validation.html">6. Validating ISA-Tab and ISA JSON</a>
  </li>
  <li class="">
    <a href="../conversions.html">7. Converting between ISA format</a>
  </li>
  <li class="">
    <a href="../importdata.html">8. Importing data into ISA formats</a>
  </li>
  <li class="">
    <a href="../exportdata.html">9. Exporting data from ISA formats</a>
  </li>
  <li class="">
    <a href="../examples.html">10. Example programs using the ISA API</a>
  </li>
  <li class="">
    <a href="../github.html">11. Downloading files stored in Github</a>
  </li>
  <li class="">
    <a href="../knownissues.html">12. Known issues</a>
  </li>
  <li class="">
    <a href="isa-create-sample-assay-plan-htp-imaging.html">13. ISA Create - Sample Assay Plan as a Graph: Phenotyping by HT imaging Spectrometry</a>
  </li>
  <li class="">
    <a href="isa-create-sample-assay-plan-lc-dad.html">14. ISA Create - Sample Assay Plan as a Graph: LC-Diode-Array-Assay Spectrometry</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/notebooks/studydesigncreation.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/isa-tools/isa-cookbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/isa-tools/isa-cookbook/issues/new?title=Issue%20on%20page%20%2Fcontent/notebooks/studydesigncreation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/isa-tools/isa-cookbook/edit/main/isa-book/content/notebooks/studydesigncreation.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#getting-started" class="nav-link">Getting started</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#creation-of-treatments-treatment-treatmentfactory-treatmentsequence" class="nav-link">Creation of treatments: Treatment, TreatmentFactory, TreatmentSequence</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#creation-of-sample-and-assay-plans" class="nav-link">Creation of Sample and Assay Plans</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#taking-into-account-the-specifics-of-data-acquisition-events-dependent-on-methodology-and-technology" class="nav-link">Taking into account the specifics of Data Acquisition events dependent on methodology and technology</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/isa-tools/isa-cookbook/edit/main/isa-book/content/notebooks/studydesigncreation.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="study-design-driven-creation-of-isa-content">
<h1>Study-design-driven creation of ISA content<a class="headerlink" href="#study-design-driven-creation-of-isa-content" title="Permalink to this headline">¶</a></h1>
<p>In addition to the basic classes for creating ISA objects (such as
<code class="docutils literal notranslate"><span class="pre">Investigation</span></code>, <code class="docutils literal notranslate"><span class="pre">Study</span></code>, <code class="docutils literal notranslate"><span class="pre">Assay</span></code> described previously), the ISA API
also provides a set of helper Python classes to bootstrap the creation
of ISA documents from key parameters obtained from the Design of
Experiment (DoE). The methods allow the creation of the study Treatment
plan, the Sample collection Plan and the study assay plan.</p>
<p>The core functions of the ISA-API create mode which are covered in this
section are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InterventionStudyDesign</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Treatment</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TreatmentFactory</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TreatmentSequence</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SampleAssayPlan</span></code></p></li>
<li><p>Assay ‘topology modifiers’ that support creating experimental
graphs with specific characteristics for different technologies,
such as <code class="docutils literal notranslate"><span class="pre">MSAssayTopologyModifiers</span></code> and
<code class="docutils literal notranslate"><span class="pre">DNASeqAssayTopologyModifiers</span></code></p></li>
</ul>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>The package containing all the classes for study-design-based creation
of ISA content is <code class="docutils literal notranslate"><span class="pre">isatools.create..model</span></code>.</p>
<p>To use this package, include the following import statement in your
code, which includes all the objects available in the package</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from isatools.create.models import *
</pre></div>
</div>
<p>Alternatively, you can include specific classes and objects that you are
interested in. For example</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from isatools.create.models import *

from isatools.create.models import (InterventionStudyDesign, Treatment,
                                Characteristic, TreatmentFactory,
                                TreatmentSequence, AssayType,
                                SampleAssayPlan, INTERVENTIONS,
                                BASE_FACTORS_ as BASE_FACTORS,
                                IsaModelObjectFactory,
                                MSAssayTopologyModifiers,
                                DNASeqAssayTopologyModifiers)
</pre></div>
</div>
<p>Currently, we only support intervention designs by creating objects of
the class <code class="docutils literal notranslate"><span class="pre">`InterventionStudyDesign</span></code>` (see code snippet below). We
will soon also support observation designs.</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>&gt;&gt;&gt; study_design = InterventionStudyDesign()</p>
<p>The definition of <a class="reference external" href="http://purl.obolibrary.org/obo/OBI_0000115">intervention
design</a> according to the
<a class="reference external" href="http://obi-ontology.org/">Ontology for Biomedical Investigations</a> is:</p>
<p>::: {.note}
::: {.admonition-title}
Note
:::</p>
<p>“An intervention design is a study design in which a controlled process
applied to the subjects (the intervention) serves as the independent
variable manipulated by the experimentalist. The treatment (perturbation
or intervention) defined can be defined as a combination of values taken
by independent variable manipulated by the experimentalists are applied
to the recruited subjects assigned (possibly by applying specific
methods) to treatment groups. The specificity of intervention design is
the fact that independent variables are being manipulated and a response
of the biological system is evaluated via response variables as
monitored by possibly a series of assays.”
:::</p>
</div>
<div class="section" id="creation-of-treatments-treatment-treatmentfactory-treatmentsequence">
<h2>Creation of treatments: Treatment, TreatmentFactory, TreatmentSequence<a class="headerlink" href="#creation-of-treatments-treatment-treatmentfactory-treatmentsequence" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Treatment</span></code> class is defined as a tuple of factor values (as defined
in the ISA model v1) and a treatment type.</p>
<p>To create a treatment object, you need to identify the <code class="docutils literal notranslate"><span class="pre">StudyFactor</span></code>s
and their <code class="docutils literal notranslate"><span class="pre">FactorValue</span></code>s as the treatment is a specific combination of
factor values:</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>agent = StudyFactor(name=&quot;agent&quot;, factor_type=&quot;agent value&quot;)
intensity = StudyFactor(name=&quot;intensity&quot;, factor_type=&quot;intensity value&quot;)
duration = StudyFactor(name=&quot;duration post exposure&quot;, factor_type=&quot;duration value&quot;)


treatment = Treatment(treatment_type=INTERVENTIONS[&#39;CHEMICAL&#39;],
    factor_values=(
        FactorValue(factor_name=agent, value=&#39;ibuprofen&#39;),
        FactorValue(factor_name=intensity, value=&#39;low dose&#39;),
        FactorValue(factor_name=duration, value=&#39;2 hr&#39;)
    ))
</pre></div>
</div>
<p>For convenience, a few objects are provided with some common:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INTERVENTIONS</span></code> such as chemical, behavioural, surgical, biological,
radiological, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BASE_FACTORS</span></code> representing a perturbation agent, intensity and
duration of the treatment</p></li>
</ul>
<p>but if these are not suitable for your purposes, you can build your own
intervention type and factors.</p>
<p>In the example above we use one of the common interventions but created
our own set of <code class="docutils literal notranslate"><span class="pre">StudyFactor</span></code>s.</p>
<p>Instead of creating individual treatments, you may want to create all
the treatments required for a specific design type.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TreatmentFactory</span></code> class provides utility methods to create a set of
<code class="docutils literal notranslate"><span class="pre">Treatment</span></code> objects. One of the utility methods is that for creating the
set of treatments corresponding to a full factorial design (using method
<code class="docutils literal notranslate"><span class="pre">compute_full_factorial_design</span></code>). This computes all the combinations of
factor values, returning an empty set if one of the factors has no
associated values.</p>
<p>An example of using the <code class="docutils literal notranslate"><span class="pre">TreatmentFactory</span></code> class is as follows:</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>treatment_factory = TreatmentFactory(factors=[agent, intensity, duration])}
treatment_factory.add_factor_value(agent, {&#39;acetyl salicylic acid&#39;, &#39;acetaminophen&#39;, &#39;ibuprofen&#39;})
treatment_factory.add_factor_value(intensity, {&#39;high dose&#39;, &#39;low dose&#39;, &#39;medium dose&#39;})
treatment_factory.add_factor_value(duration, {&#39;2 hr&#39;, &#39;4 hr&#39;})

factorial_design_treatments = treatment_factory.compute_full_factorial_design()
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">factorial_design_treatments</span></code> object will contain the set of 18
treatments that result from performing all the combinations of the 3x3x2
factor values shown above.</p>
<p>A set of treatments may be combined in a <code class="docutils literal notranslate"><span class="pre">TreatmentSequence</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TreatmentSequence</span></code> class provides a way of building is an ordered
sequence of treatments, where each treatment is assigned a rank, or
epoch number, with the following properties: the epoch numbers always
start with 1 (lowest epoch number), all epochs should be positive
integers, epoch numbers may be repeated (for concomitant treatments), no
value should be missing between the lowest epoch (1) and the highest
epoch.</p>
<div class="highlight-{.sourceCode notranslate"><div class="highlight"><pre><span></span>treatment_sequence = TreatmentSequence(
ranked_treatments={ (x, (i+1)) for i, x in enumerate(factorial_design_treatments)}
)}
</pre></div>
</div>
</div>
<div class="section" id="creation-of-sample-and-assay-plans">
<h2>Creation of Sample and Assay Plans<a class="headerlink" href="#creation-of-sample-and-assay-plans" title="Permalink to this headline">¶</a></h2>
<p>After you have identified the treatments, to describe your experiment
fully you will need to indicate the sampling plan (i.e. in which way you
select the samples) as well as the assay plan (i.e. what measurements
you are taken from the samples). For this purpose, we provide the
<code class="docutils literal notranslate"><span class="pre">SampleAssayPlan</span></code> class.</p>
</div>
<div class="section" id="taking-into-account-the-specifics-of-data-acquisition-events-dependent-on-methodology-and-technology">
<h2>Taking into account the specifics of Data Acquisition events dependent on methodology and technology<a class="headerlink" href="#taking-into-account-the-specifics-of-data-acquisition-events-dependent-on-methodology-and-technology" title="Permalink to this headline">¶</a></h2>
<p>The Assay ‘topology modifiers’ functions (such as
<code class="docutils literal notranslate"><span class="pre">MSAssayTopologyModifiers</span></code> for Mass Spectrometry based assays or
<code class="docutils literal notranslate"><span class="pre">DNASeqAssayTopologyModifiers</span></code> for DNA sequence assays) are present to
support specific branching or pooling events affecting the underlying
experimental graph, which we aim to represent with ISA objects.
Depending on the assay and the technology used to acquire data, the
number of ‘hinge points’ may vary but the basic principle remains the
same. Some are common to all: for instance, irrespective of the
technique, one may carry out several data acquisition on the same input
material (technical replication). On the other hand, when using a
technique such as mass spectrometry an range of setting may be set by
the operators, such as the type of injections modes, the type of
acquisition modes. When using sequencing technology, different
instruments may be used, libraries may be prepared as single or paired
ends. The ‘Topology Modifiers’ method in the ISA-API allows to specify
those in a flexible yet generic way.</p>
<p>We will explain each of these objects and how to use them below.</p>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The ISA Team<br/>
        
            &copy; Copyright 2021 (CC-BY 4.0).<br/>
          <div class="extra_footer">
            <script>mermaid.init();</script> <div class="row_footer"> This page was created thanks to work by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></div> <div class="row_footer"> This project is supported financially by the <a href="https://wellcome.org/">Welcome Trust</a>, Elixir-UK and the European Union</div>
<div class="row_footer"> <div class="column" style="center"><a href="https://wellcome.org/"><img src="../_static/images/logo/wellcome-logo-black.png" height="25" alt="Wellcome" style="float:center""></a></div> <div class="column"><a href="https://www.elixir-uk.org.eu/"><img src="../_static/images/logo/elixir-uk_transparent.png" height="40" alt="IMI logo" style="float:center""></a></div> <div class="column"><a href="https://https://ec.europa.eu/programmes/horizon2020/en"><img src="../_static/images/logo/eu-flag-recolored.png" height="25" alt="EFPIA logo" style="float:center""></a></div> </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>